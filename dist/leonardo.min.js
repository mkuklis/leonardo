(function(){var a=this,b=a.document;this.Leonardo=function(){this.canvas=c.createCanvas.apply(this,arguments),this.ctx=this.canvas.getContext("2d"),this.elements=[],c.init.call(this)};var c=Leonardo;c.version=.1,c.debug=!1,c.init=function(a){if(a)this.inits=this.inits||[],this.inits.push(a);else{var b=this.constructor;b.inits&&b.inits.forEach(function(a){a.call(this)},this)}},c.fn={constructor:c,circle:function(a,b,d,e,f){var g={x:a||0,y:b||0,r:d||0},h=c.E("circle",c.extend(g,e),this);return f=f||{},f.silent||h.draw(),h},rect:function(a,b,d,e,f,g){var h={x:a||0,y:b||0,w:d||0,h:e||0,r:f||0},i=c.E("rect",c.extend(h,g),this);return i.draw(),i},path:function(a,b){var d;return c.is("Array",a)&&(a={path:a}),b=b||{},d=c.E("path",a,this,b),b.silent||d.draw(),d},image:function(a,b,d,e,f,g){var h={src:a,x:b||0,y:d||0,w:e||0,h:f||0},i=c.E("image",c.extend(h,g),this);return i.draw(),i},redraw:function(){this.clear();for(var a=0,b=this.elements.length;a<b;a++)this.elements[a].draw()},reset:function(){this.elements.splice(0,this.elements.length),this.flags={},this.clear()},clear:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath()},getPx:function(a,b){return this.ctx.getImageData(a,b,1,1).data},getPxColor:function(a,b){var d=this.getPx(a,b);return d[0]===0&&d[1]===0&&d[2]===0?d[3]===0?"#ffffff":"#000000":"#"+c.C.rgbToHex(d[0],d[1],d[2])}},c.prototype=c.fn,c.toString=function(){return"Leonardo ver. "+c.version},c.proxy=function(a,b){return function(){a.apply(b,arguments)}},c.createCanvas=function(){var a,e=arguments;return e.length==4?c.isAllN(e)&&(a=b.createElement("canvas"),a.style.position="absolute",a.style.left=e[0]+"px",a.style.top=e[1]+"px",a.width=e[2],a.height=e[3],b.body.appendChild(a)):c.is("String",e[0])&&(a=b.getElementById(e[0])),a},c.extend=function(a){return[].slice.call(arguments,1).forEach(function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},c.is=function(a,b){var d=c.typeOf(b);return typeof b!="undefined"&&b!==null&&d===a},c.typeOf=function(a){return Object.prototype.toString.call(a).slice(8,-1)},c.A=[],c.isAllN=function(a){for(var b=0,d=a.length;b<d;b++)if(!c.is("Number",a[b]))return!1;return!0},c.uuid=function d(a){return a?(a^Math.random()*16>>a/4).toString(16):([1e7]+ -1e3+ -4e3+ -8e3+ -1e11).replace(/[018]/g,d)},c.rad=function(a){return a%360*Math.PI/180},c.deg=function(a){return a*180/Math.PI%360}}).call(this),function(a){a.C={rgbRegex:/^rgb\(([0-255]{1,3}),\s*([0-255]{1,3}),\s*([0-255]{1,3})\)$/ig,singleHexRegex:/^([a-f0-9])([a-f0-9])([a-f0-9])$/i,tripleHexRegex:/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,h2rgb:function(a){a=a[0]=="#"?a.substr(1):a;if(a.length==3){var b=this.singleHexRegex.exec(a).slice(1);for(var c=0;c<3;c++)a+=b[c]}var d=this.tripleHexRegex.exec(a).slice(1);return{r:parseInt(d[0],16),g:parseInt(d[1],16),b:parseInt(d[2],16)}},txt2rgb:function(a){var b=d.getElementById("txt2rgb");return b||(b=d.createElement("div"),attr=d.createAttribute("id"),attr.value="txt2rgb",b.setAttributeNode(attr),b.style.display="none",d.body.appendChild(b)),b.style.color=a,ww.getComputedStyle(b).color},rgb2rgba:function(a,b){return a=this.rgbRegex.exec(color),a&&a.length==4?"rgba("+a[1]+", "+a[2]+", "+a[3]+", "+b+")":a},toColor:function(a,b){if(typeof b!="undefined"){if(a.indexOf("rgba")>-1)return a;if(a.charAt()==="#"){var c=this.h2rgb(a);return"rgba("+c.r+", "+c.g+", "+c.b+", "+b+")"}return a.indexOf("rgb")>-1?this.rgb2rgba(a):this.rgb2rgba(this.txt2rgb(a))}return a},d2c:function(a){return"#"+this.d2h(a[0])+this.d2h(a[1])+this.d2h(a[2])},rgb2h:function(a,b,c){return this.d2h(a)+this.d2h(b)+this.d2h(c)},h2d:function(a){return parseInt(a,16)},d2h:function(a){return a=parseInt(a,10),isNaN(a)?"00":(a=Math.max(0,Math.min(a,255)),"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16))},c2d:function(a){var b=this.h2rgb(a);return[b.r,b.g,b.b]}}}(Leonardo),function(a){function b(){this.reset()}b.prototype={reset:function(){this.m=[[1,0,0],[0,1,0],[0,0,1]]},add:function(a,b,c,d,e,f){var g=[[],[],[]],h=[[a,c,e],[b,d,f],[0,0,1]],i,j,k,l;for(i=0;i<3;i++)for(j=0;j<3;j++){l=0;for(k=0;k<3;k++)l+=this.m[i][k]*h[k][j];g[i][j]=l}this.m=g},translate:function(a,b){this.add(1,0,0,1,a,b)},scale:function(a,b,c,d){b===null&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},rotate:function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var e=Math.cos(b).toFixed(9),f=Math.sin(b).toFixed(9);this.add(e,f,-f,e,c,d),this.add(1,0,0,1,-c,-d)},x:function(a,b){return a*this.m[0][0]+b*this.m[0][1]+this.m[0][2]},y:function(a,b){return a*this.m[1][0]+b*this.m[1][1]+this.m[1][2]},xy:function(a,b){return[this.x(a,b),this.y(a,b)]}},a.matrix=function(){return new b},a.Matrix=b}(Leonardo),function(a){var b={M:function(a){this.ctx.moveTo(a[0],a[1]),this.updateBbox({x:a[0],y:a[1]})},L:function(a){for(var b=0,c=a.length;b<c;b+=2)this.ctx.lineTo(a[b],a[b+1]),this.updateBbox({x:a[b],y:a[b+1]})},V:function(a){this.ctx.lineTo(this.bbox.x,a)},H:function(a){this.ctx.lineTo(a,this.bbox.y)},Q:function(a){for(var b=0,c=a.length;b<c;b+=4)this.ctx.quadraticCurveTo(a[b],a[b+1],a[b+2],a[b+3]),this.updateBbox({x:a[b+2],y:a[b+3]})},B:function(a){for(var b=0,c=a.length;b<c;b+=6)this.ctx.bezierCurveTo(a[b],a[b+1],a[b+2],a[b+3],a[b+4],a[b+5]),this.updateBbox({x:a[b+4],y:a[b+5]})}},c={rotate:function(a){this.m.rotate(a.angle),this.ctx.rotate(a.angle*Math.PI/180)},scale:function(a){this.m.scale(a.sx,a.sy),this.ctx.scale(a.sx,a.sy)}},d={circle:function(a){this.ctx.arc(a.tx,a.ty,a.r,0,Math.PI*2,!0),this.updateBbox({x:a.tx-a.r,y:a.ty-a.r,w:2*a.r,h:2*a.r})},rect:function(a){this.ctx.rect(a.tx,a.ty,a.w,a.h),this.updateBbox({x:a.tx,y:a.ty,w:a.w,h:a.h})},path:function(){this.attrs.path.forEach(this.processPath,this)},image:function(a){this.processImage(),this.updateBbox({x:a.x,y:a.y,w:a.w,h:a.h})}},e=function(b,c,d,f){if(this instanceof e)this.type=b,this.attrs=c,this.attrs.dx=0,this.attrs.dy=0,this.l=d,this.ctx=this.l.ctx,this.m=new a.Matrix,this.t=[],this.bbox={x:Infinity,y:Infinity,w:0,h:0},f=f||{},f.back?this.l.elements.unshift(this):this.l.elements.push(this),this.updateCoords(),this.id=a.uuid(),e.init.call(this);else return new e(b,c,d,f)};e.init=a.init,e.fn={constructor:e,attr:function(b,c){if(a.is("String",b))return this.attrs[b];if(a.is("Array",b)){var d=[];for(var e=0,f=b.length;e<f;e++)d.push(this.attrs[b[e]]);return d}c=c||{};for(var g in b)this.attrs[g]=b[g];return c.silent||this.redraw(),this},redraw:function(){this.l.redraw()},draw:function(){var b=this.attrs;this.ctx.save(),this.ctx.beginPath(),b.fill&&(this.ctx.fillStyle=this.createStyle()),b.stroke=b.stroke||"#000000",this.ctx.strokeStyle=a.C.toColor(b.stroke,b["stroke-opacity"]),this.ctx.lineWidth=b["stroke-width"]||1,this.t.length&&this.transform(),this.updateCoords(),d[this.type]&&d[this.type].call(this,b),b.fill&&this.ctx.fill(),b.text&&this.processText(),this.ctx.stroke(),a.debug&&(this.ctx.rect(this.bbox.x,this.bbox.y,this.bbox.w,this.bbox.h),this.ctx.stroke()),this.ctx.closePath(),this.ctx.restore()},createStyle:function(){var b=this.attrs;return e.isGradient(b.fill)?this.parseGradient(b.fill):a.C.toColor(b.fill,b.opacity)},processText:function(){var a=this.attrs,b=a["text-position"]||"center:middle",c=a["font-color"]||"rgba(0,0,0,1.0)",d=a.font||"10px sans-serif",e=b.split(":");e.length==1&&e.push("middle"),this.ctx.textAlign=e[0],this.ctx.textBaseline=e[1],this.ctx.fillStyle=c,this.ctx.font=d,this.ctx.fillText(a.text,a.x-a.dx,a.y-a.dy)},processImage:function(){var b=this.attrs;this.img?this.ctx.drawImage(this.img,b.x,b.y,b.w,b.h):(this.img=new Image,this.img.onload=a.proxy(function(){this.ctx.drawImage(this.img,b.x,b.y,b.w,b.h)},this),this.img.src=b.src)},parseGradient:function(a){var b=a.split(":"),c=this.attrs,d=b.shift(),e=b[b.length-1],f,g;e.indexOf("-")==-1&&(f=b.pop().split(",")),d==="r"?(f=f?f:[c.x-c.dx,c.y-c.dy,0,c.x-c.dx,c.y-c.dy,c.r],g=this.ctx.createRadialGradient.apply(this.ctx,f)):(f=f?f:[c.x,c.y,c.w,c.h],g=this.ctx.createLinearGradient.apply(this.ctx,f));for(var h=0,i=b.length;h<i;h++){var j=b[h].split("-");g.addColorStop(j[0],C.toColor(j[1]))}return g},processPath:function(a){for(var c in a)b[c].call(this,a[c])},rotate:function(a,b,c){var d=this.attrs;return typeof b=="undefined"&&(b=d.w/2,c=d.h/2),d.cx=b,d.cy=c,d.tx=-b,d.ty=-c,this.t.push({c:"rotate",angle:a,cx:b,cy:c}),this.redraw(),this},scale:function(a,b,c,d){var e=this.attrs;return typeof c=="undefined"&&(c=e.w/2,d=e.h/2),e.cx=c,e.cy=d,e.tx=-c,e.ty=-d,this.t.push({c:"scale",sx:a,sy:b,cx:c,cy:d}),this.redraw(),this},transform:function(){var a=this.attrs;this.m.reset(),this.m.translate(a.x+a.cx,a.y+a.cy),this.ctx.translate(a.x+a.cx,a.y+a.cy),this.t.forEach(function(a){c[a.c].call(this,a)},this)},updateBbox:function(a){var b=this.bbox;a.w&&a.h?this.bbox=a:a.x&&a.y&&(a.x<b.x&&(b.x=a.x),a.x>b.x+b.w&&(b.w=a.x-b.x),a.y<b.y&&(b.y=a.y),a.y>b.y+b.h&&(b.h=a.y-b.y))},getBbox:function(){return this.bbox},updateCoords:function(){var a=this.attrs;if(this.t.length)this.coords=[[a.tx,a.ty],[a.tx+a.w,a.ty],[a.tx+a.w,a.ty+a.h],[a.tx,a.ty+a.h]],this.coords.forEach(function(a,b){this.coords[b]=this.m.xy(a[0],a[1])},this);else{var b=a.x,c=a.y,d=a.w,e=a.h;a.tx=b,a.ty=c,this.coords=[[b,c],[b+d,c],[b+d,c+e],[b,c+e]]}}},e.isGradient=function(a){return a[0]=="r"||a[0]=="l"},e.prototype=e.fn,a.E=e}(Leonardo),function(a){a.ev=function(a){function c(a,c,d){b[a]=b[a]||[],b[a].push({fn:c,ctx:d||this})}function d(a){if(a in b)b[a].splice(b[a].indexOf(this),1);else return}function e(a){var c=b[a],d=c.indexOf(this);return d<c.length-1?(c.splice(d,1),c.push(this),d):-1}function f(c){var d,e;if(!(c in b))return;d=a.call(arguments,1),e=b[c];for(var f=e.length-1;f>=0;f--){var g=e[f];g.fn.apply(g.ctx,d)}}var b=[];return function(){return this.ev={on:c,off:d,reorder:e,trigger:f},this}}([].slice)}(Leonardo),function(a){function g(a){var b,c;return a.touches?(b=a.touches[0].pageX-a.target.offsetLeft,c=a.touches[0].pageY-a.target.offsetTop):(b=a.pageX-a.target.offsetLeft,c=a.pageY-a.target.offsetTop),{x:b,y:c}}function h(a,b){var c,d;if(a.type=="circle")return c=Math.pow(a.attrs.x-b.x,2)+Math.pow(a.attrs.y-b.y,2),c<=a.attrs.r*a.attrs.r;d=a.coords;for(var e=!1,f=-1,g=d.length,h=g-1;++f<g;h=f)(d[f][1]<=b.y&&b.y<d[h][1]||d[h][1]<=b.y&&b.y<d[f][1])&&b.x<(d[h][0]-d[f][0])*(b.y-d[f][1])/(d[h][1]-d[f][1])+d[f][0]&&(e=!e);return e}var b=a.E,c="mouseover mouseout mousedown mouseup click".split(" "),d="mousedown mouseup mousemove click".split(" "),e={mouseover:"mousemove",mouseout:"mousemove",dragmove:"mousemove",dragstart:"mousedown",dragend:"mouseup"},f={click:function(a){h(this,a)&&this.execCallbacks("click")},mousemove:function(a,b){if(this.flags.dragging)this.attr({x:a.x-this.attrs.dx,y:a.y-this.attrs.dy});else if(!this.flags.over&&h(this,a)){var c=this.l.flags.mouseover;if(!c||b>c||this.l.flags.dragging){if(b>c){var d=this.l.elements[c];d.execCallbacks("mouseout"),d.flags.over=!1}return this.execCallbacks("mouseover"),this.l.flags.mouseover=b,this.flags.over=!0,!0}}else this.flags.over&&!h(this,a)&&(this.flags.over=!1,this.execCallbacks("mouseout"),delete this.l.flags.mouseover)},mousedown:function(a){if(h(this,a))return!this.l.flags.dragging&&this.callbacks.dragstart?(this.flags.dragging=!0,this.l.flags.dragging=!0,this.toFront(),this.attr({dx:a.x-this.attrs.x,dy:a.y-this.attrs.y},{silent:!0}),this.execCallbacks("dragstart")):this.execCallbacks("mousedown"),!0},mouseup:function(a){this.callbacks.dragend&&this.flags.dragging?(this.flags.dragging=!1,this.l.flags.dragging=!1,this.execCallbacks("dragend")):this.execCallbacks("mouseup")}};a.fn.toFront=function(a){var b=this.elements,c=b.indexOf(a);c<b.length-1&&(b.splice(c,1),b.push(a))};var i=function(b){this.canvas.addEventListener(b,a.proxy(function(a){this.ev.trigger(b,g(a)),a.preventDefault()},this))};a.init(function(){this.flags={};for(var b=0,c=d.length;b<c;b++)a.proxy(i,this)(d[b])}),b.init(function(){this.flags={},this.callbacks={}}),b.fn.drag=function(a,b,c){return this.on("dragstart",a),this.on("dragmove",b),this.on("dragend",c),this},b.fn.undrag=function(){return this.off("dragstart"),this.off("dragmove"),this.off("dragend"),this},b.fn.on=function(a,b){return this.callbacks[a]=this.callbacks[a]||[],this.ev.on(e[a]||a,f[e[a]]),b&&this.callbacks[a].push(b),this},b.fn.off=function(a,b){if(this.callbacks[a]){if(b){var c=this.callbacks[a].indexOf(b);this.callbacks[a].splice(c,1)}else delete this.callbacks[a];this.ev.off(e[a]||a)}return this},b.fn.execCallbacks=function(b){var c=this.callbacks[b];if(c)for(var d=0,e=c.length;d<e;d++)a.is("Function",c[d])&&c[d].call(this)},c.forEach(function(a){b.fn[a]=function(b){return this.on(a,b),this},b.fn["un"+a]=function(b){return this.off(a,b),this}}),b.fn.toFront=function(){this.l.toFront(this);var a=this.reorder("mousedown");a>-1&&(this.l.flags.mouseover=a,this.redraw())},a.ev.call(a.prototype),a.ev.call(a.E.prototype)}(Leonardo),function(a){var b=0,c=["ms","moz","webkit","o"];for(var d=0,e=c.length;d<e&&!a.requestAnimationFrame;++d)a.requestAnimationFrame=a[c[d]+"RequestAnimationFrame"],a.cancelRequestAnimationFrame=a[c[d]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(c,d){var e=(new Date).getTime(),f=Math.max(0,16-(e-b)),g=a.setTimeout(function(){c(e+f)},f);return b=e+f,g}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}(window),function(a){a.easings={easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-0.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return a===0?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return a===1?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return a===0?0:a===1?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-0.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a=a-1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((a*6-1)*2*Math.PI/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-0.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)}}}(Leonardo),function(a){function c(a,b,c,d,e){this.sv=a,this.ev=b,this.st=c,this.ms=d,this.easing=e||"easeInQuad"}var b=a.E;a.fn.animate=function(){requestAnimationFrame(a.proxy(function(){if(this.fxcounter>0){this.clear();for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];c.processFx(),c.draw()}}this.animate()},this))},a.now=function(){return Date.now?Date.now():(new Date).getTime()},a.init(function(){this.fxcounter=0,this.ev.on("fx:add",function(){this.fxcounter+=1},this),this.ev.on("fx:remove",function(){this.fxcounter-=1},this),this.animate()}),c.prototype={run:function(){var b=[];if(a.is("Array",this.ev)){for(var c=0,d=this.ev.length;c<d;c++)b.push(this.process(this.sv[c],this.ev[c]));return b}return this.process(this.sv,this.ev)},process:function(b,c){var d=(c-b)*a.easings[this.easing]((a.now()-this.st)/this.ms)+b;return c>b?d>c?c:d:d<c?c:d},updateTime:function(a){this.st+=a}};var d={fill:function(b){return a.C.c2d(b)}},e={fill:function(b){return a.C.d2c(b)}},f={Function:function(a){this.endFn=a},Number:function(a){this.duration=a},String:function(a){this.easing=a},Object:function(a){this.duration=a.duration,this.easing=a.easing,this.endFn=a.end,this.stepFn=a.step}};a.Animation=function(b,c,d){d=a.A.slice.call(arguments,2),this.el=b,this.sttrs=b.attrs,this.attrs=c,this.status="play";for(var e=0,g=d.length;e<g;e++){var h=d[e];f[a.typeOf(h)].call(this,h)}this.duration=this.duration||400,this.easing=this.easing||"easeInQuad"},a.Animation.prototype={start:function(){var a,b,c;this.tweens=[];for(var e in this.attrs)c=d[e],c?(sv=c(this.sttrs[e]),b=c(this.attrs[e]),this.addTween(sv,b)):this.addTween(this.sttrs[e],this.attrs[e])},addTween:function(b,d){this.st=a.now();var e=new c(b,d,this.st,this.duration,this.easing);this.tweens.push({attr:attr,tween:e})},resume:function(){var b=a.now()-this.ptime;for(var c=0,d=this.tweens.length;c<d;c++)this.tweens[c].tween.updateTime(b);this.status="play"},stop:function(){this.el.curAnim=null,this.endFn&&this.endFn.call(this.el),this.el.ev.trigger("fx:remove",this)},isActive:function(){return this.status=="play"},pause:function(){this.ptime=a.now(),this.status="pause"},step:function(){var a,b,c,d,f=!1;for(var g=0,h=this.tweens.length;g<h;g++)a=this.tweens[g].attr,b=this.tweens[g].tween,d=e[a],c=b.run(),this.sttrs[a]=d?d(c):c,f=this.sttrs[a]==this.attrs[a];f&&this.stop()}},b.init(function(){this.animations=[]}),b.fn.animate=function(b,c){var d=new a.Animation(this,b,c);return this.ev.trigger("fx:add",this),this.animations.push(d),this},b.fn.pause=function(){this.curAnim&&this.curAnim.isActive()&&this.curAnim.pause()},b.fn.resume=function(){this.curAnim&&!this.curAnim.isActive()&&this.curAnim.resume()},b.fn.processFx=function(){return this.animations.length>0&&!this.curAnim?(this.curAnim=this.animations.shift(),this.curAnim.start()):this.curAnim&&this.curAnim.isActive()&&this.curAnim.step(),this}}(Leonardo);